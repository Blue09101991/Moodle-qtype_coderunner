{"version":3,"file":"ajaxquestionloader.min.js","sources":["../src/ajaxquestionloader.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript for filling in the question text with the contents of one\n * of the question's support files. Intended primarily for program contest\n * problems, where the support file is a single domjudge or ICPC problem zip,\n * with the problem spec within it.\n *\n * @module qtype_coderunner/ajaxquestionloader\n * @copyright  Richard Lobb, 2019, The University of Canterbury\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\ndefine(['jquery'], function ($) {\n    /**\n     * Append to the question text div in the question a data-URL containing\n     * the contents of the question specification file (usu. a pdf).\n     * @param {int} qid The question ID in the database.\n     * @param {string} divId The ID of the question text <div> element.\n     * @param {string} questionFilename The name of the problem spec file within\n     * the problem zip file.\n     */\n    function loadQuestionText(qid, divId, questionFilename) {\n        var questionTextDiv = $('#' + divId),\n            errorDiv = '<div style=\"colour:red\">Failed to load problem spec<div>';\n        if (questionTextDiv.length != 1) {\n            questionTextDiv.append(errorDiv);\n            return;\n        }\n        $.getJSON(M.cfg.wwwroot + '/question/type/coderunner/problemspec.php',\n                {\n                    questionid: qid,\n                    sesskey: M.cfg.sesskey,\n                    filename: questionFilename\n                },\n                function (response) {\n                    if (response.filecontentsb64) {\n\n                        questionTextDiv.append(\n                          '<div><a download href=\"data:application/pdf;base64,' +\n                          response.filecontentsb64 + '\">Problem spec</a></div>');\n                    } else {\n                        questionTextDiv.append(errorDiv);\n                    }\n\n                }\n        ).fail(function () {\n            // AJAX failed. We're dead, Fred.\n            questionTextDiv.append(errorDiv);\n        });\n    }\n\n    return {\n        loadQuestionText: loadQuestionText\n    };\n});\n"],"names":["define","$","loadQuestionText","qid","divId","questionFilename","questionTextDiv","errorDiv","length","getJSON","M","cfg","wwwroot","questionid","sesskey","filename","response","filecontentsb64","append","fail"],"mappings":";;;;;;;;;;AA2BAA,6CAAO,CAAC,WAAW,SAAUC,SAuClB,CACHC,0BA/BsBC,IAAKC,MAAOC,sBAC9BC,gBAAkBL,EAAE,IAAMG,OAC1BG,SAAW,2DACe,GAA1BD,gBAAgBE,OAIpBP,EAAEQ,QAAQC,EAAEC,IAAIC,QAAU,4CAClB,CACIC,WAAYV,IACZW,QAASJ,EAAEC,IAAIG,QACfC,SAAUV,mBAEd,SAAUW,UACFA,SAASC,gBAETX,gBAAgBY,OACd,sDACAF,SAASC,gBAAkB,4BAE7BX,gBAAgBY,OAAOX,aAIrCY,MAAK,WAEHb,gBAAgBY,OAAOX,aAtBvBD,gBAAgBY,OAAOX"}